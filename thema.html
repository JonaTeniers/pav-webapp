<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Thema</title>

<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">

<style>
:root{
--primary:#14b8a6;
--bg:#f3f6fa;
--white:#ffffff;
--border:#e2e8f0;
--text:#1e293b;
}

body{
margin:0;
font-family:'Nunito',sans-serif;
background:var(--bg);
color:var(--text);
}

/* TOP BAR */
.topbar{
display:flex;
justify-content:space-between;
align-items:center;
padding:20px 40px;
}

.back-btn{
background:#2563eb;
color:white;
padding:10px 18px;
border-radius:10px;
text-decoration:none;
font-weight:700;
}

.xp-box{
background:white;
padding:10px 18px;
border-radius:12px;
font-weight:700;
box-shadow:0 4px 10px rgba(0,0,0,0.05);
}

/* HEADER */
.theme-header{
background:var(--primary);
color:white;
padding:40px;
text-align:center;
}

.theme-header h1{
margin:0;
font-size:2rem;
}

.theme-header p{
margin-top:10px;
opacity:0.9;
}

/* CONTENT GRID */
.content{
max-width:1200px;
margin:40px auto;
display:grid;
grid-template-columns:2fr 1fr;
gap:30px;
padding:0 20px;
}

/* LEFT CARD */
.card{
background:white;
border-radius:18px;
padding:30px;
box-shadow:0 6px 18px rgba(0,0,0,0.05);
}

.card h2{
margin-top:0;
}

.card hr{
border:none;
height:1px;
background:#e5e7eb;
margin:25px 0;
}

/* UNITS */
.units{
margin-top:40px;
}

.units-grid{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
gap:20px;
}

.unit-card{
background:#ecfdf5;
padding:18px;
border-radius:14px;
text-decoration:none;
color:var(--text);
font-weight:600;
box-shadow:0 4px 10px rgba(0,0,0,0.04);
transition:0.2s;
}

.unit-card:hover{
transform:translateY(-4px);
}

.placeholder{
text-align:center;
opacity:0.7;
}

.placeholder img{
width:120px;
margin-bottom:15px;
}

/* CHAT CARD */
.chat-card{
background:white;
border-radius:18px;
padding:25px;
box-shadow:0 6px 18px rgba(0,0,0,0.05);
}

.chat-card button{
margin-top:15px;
width:100%;
padding:10px;
border-radius:10px;
border:none;
background:#10b981;
color:white;
font-weight:700;
cursor:pointer;
}

@media(max-width:900px){
.content{
grid-template-columns:1fr;
}
}
</style>
</head>

<body>

<div class="topbar">
<a href="index.html" class="back-btn">Terug naar dashboard</a>
<div class="xp-box" id="xpBox">XP: 0</div>
</div>

<div class="theme-header">
<h1 id="themeTitle">Thema titel</h1>
<p id="themeDesc">Beschrijving van het thema</p>
</div>

<div class="content">

<div>

<div class="card">
<h2>Focus van dit thema</h2>
<p id="focusText">Focus wordt hier weergegeven.</p>

<hr>

<h3>Wat oefen je?</h3>
<ul id="skillsList">
<li>Vaardigheid 1</li>
<li>Vaardigheid 2</li>
</ul>
</div>

<div class="units">
<h2>Units</h2>
<div class="units-grid" id="unitsGrid"></div>
</div>

</div>

<div class="chat-card">
<h3>Chattie</h3>
<p>Laat Chattie je helpen bij dit thema.</p>
<button onclick="openChattie()">Open Chattie</button>
</div>

</div>

<script src="./firebase.js"></script>

<script>
const params = new URLSearchParams(window.location.search);
const themeId = params.get("id");

const unitsGrid = document.getElementById("unitsGrid");
const xpBox = document.getElementById("xpBox");

async function loadTheme(){
await window.firebaseReady;

const doc = await window.db.collection("themes").doc(themeId).get();

if(!doc.exists){
document.getElementById("themeTitle").innerText="Thema niet gevonden";
return;
}

const theme = doc.data();

document.getElementById("themeTitle").innerText = theme.title;
document.getElementById("themeDesc").innerText = theme.description;
document.getElementById("focusText").innerText = theme.focus || "";

document.getElementById("skillsList").innerHTML="";
(theme.skills || []).forEach(skill=>{
document.getElementById("skillsList").innerHTML += `<li>${skill}</li>`;
});

/* XP berekenen */
let totalXP = 0;
(theme.units || []).forEach(u=>{
totalXP += u.xp || 0;
});
xpBox.innerText = "XP: " + totalXP;

/* Units */
unitsGrid.innerHTML="";

if(!theme.units || theme.units.length === 0){
unitsGrid.innerHTML=`
<div class="placeholder">
<img src="img/images/pavobouwmascotte.png">
<p>Hier komt binnenkort een nieuwe unit.</p>
</div>`;
return;
}

theme.units.forEach((unit,index)=>{
unitsGrid.innerHTML+=`
<a href="unit.html?theme=${themeId}&unit=${index}" class="unit-card">
${unit.title}
<br>
<small>${unit.xp || 0} XP</small>
</a>`;
});
}

function openChattie(){
window.location.href = "chattie.html?thema=" + document.getElementById("themeTitle").innerText;
}

loadTheme();
</script>

</body>
</html>

