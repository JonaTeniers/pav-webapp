<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" href="data:," />
  <title>Thema 7 - Doel 2</title>

  <style>
    body { font-family: "Segoe UI", sans-serif; background: #f7f8fb; padding: 2rem; margin: 0; }
    h1 { text-align: center; color: #1f58a8; }
    .question-box { background: white; padding: 2rem; margin: 2rem auto; border-radius: 12px; max-width: 760px; box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1); }
    button { background: #2d74d8; color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; margin-top: 1rem; cursor: pointer; font-size: 1rem; }
    .feedback { margin-top: 1rem; font-weight: bold; padding: 1rem; border-radius: 8px; }
    .success { background-color: #c8e6c9; color: #2e7d32; }
    .error { background-color: #ffcdd2; color: #c62828; }
    .nav-buttons { margin-top: 2rem; text-align: center; }
    .hidden { display: none; }
    .helper { color: #546e7a; font-size: 0.95rem; }
    .select-input, .text-input { padding: 0.4rem; font-size: 1rem; width: min(400px, 100%); }
    .rewrite-input { width: 100%; min-height: 180px; padding: 0.6rem; font-size: 1rem; border: 1px solid #c8d6f0; border-radius: 8px; }
    .mail-example { margin-top: 0.6rem; background: #f5f7fb; border: 1px solid #dbe5f8; border-radius: 10px; padding: 0.9rem; }
    .mail-example h4 { margin: 0 0 0.6rem; color: #1f58a8; }
    .mail-example p { margin: 0.35rem 0; line-height: 1.45; }
    .unit-header { max-width: 760px; margin: 0 auto 1.5rem; display: flex; justify-content: space-between; align-items: center; gap: 1rem; }
    .unit-header a { text-decoration: none; font-weight: 700; }
    .back-link { color: #455a64; }
    .start-link { background: #2d74d8; color: white; padding: 0.4rem 0.9rem; border-radius: 999px; }
  </style>

</head>
<body>
  <h1>Thema 7 - Doel 2</h1>
  <div class="unit-header">
    <a class="back-link" href="oefenthema5.html">← Terug naar thema</a>
    <a class="start-link" href="#quizBox">Start oefenen</a>
  </div>
  <div class="question-box" id="quizBox">
    <h2 id="qCount">Vraag 1 van 10</h2>
    <p class="helper" id="qType"></p>
    <div id="questionText"></div>
    <form id="answerForm"></form>
    <button type="button" onclick="checkAnswer()">Controleer</button>
    <div class="feedback" id="feedback"></div>
    <div class="nav-buttons">
      <button id="nextBtn" class="hidden" type="button" onclick="nextQuestion()">Volgende vraag →</button>
    </div>
  </div>
  <div class="question-box hidden" id="endScreen">
    <h2>Doel voltooid!</h2>
    <p>Je behaalde <span id="xpScore">0</span> XP.</p>
    <div class="nav-buttons">
      <a href="oefenthema5.html"><button type="button">← Terug naar thema</button></a>
      <a href="thema7unit3.html"><button type="button">→ Volgend doel</button></a>
    </div>
  </div>

    <script src="./firebase.js"></script>
  <script src="./pavo-xp-sync.js"></script>
<script>
    const questions = [{"type": "mc", "typeLabel": "Meerkeuze", "question": "Welke aanhef is formeel?", "options": ["Hey jij", "Beste meneer Van Hee", "Yo"], "correctIndex": 1}, {"type": "open", "typeLabel": "Open vraag", "question": "Is 'Hoi!!!' in een mail naar school formeel of informeel?", "accepted": ["informeel"]}, {"type": "drag", "typeLabel": "Selectie", "question": "Kies formele afsluiting.", "options": ["Met vriendelijke groeten", "Groetjes", "Ciao"], "correctValue": "Met vriendelijke groeten"}, {"type": "mc", "typeLabel": "Meerkeuze", "question": "Wat is duidelijker als onderwerp?", "options": ["Help", "Inhalen toets Nederlands 2B"], "correctIndex": 1}, {"type": "open", "typeLabel": "Open vraag", "question": "Welke toon gebruik je naar een leerkracht?", "accepted": ["formeel", "beleefd", "formeel en beleefd"]}, {"type": "drag", "typeLabel": "Selectie", "question": "Kies beste zin.", "options": ["Kan ik de toets op dinsdag inhalen?", "Ik wil da ge da regelt."], "correctValue": "Kan ik de toets op dinsdag inhalen?"}, {"type": "mc", "typeLabel": "Meerkeuze", "question": "Waarom vermijd je straattaal in schoolmails?", "options": ["onprofessioneel", "korter", "altijd grappig"], "correctIndex": 0}, {"type": "open", "typeLabel": "Open vraag", "question": "Vul in: een goede mail heeft een duidelijk ...", "accepted": ["onderwerp"]}, {"type": "rewrite", "typeLabel": "Herschrijf-opdracht", "question": "Herschrijf deze e-mail zodat ze beleefd, duidelijk en respectvol is.", "mailSubject": "die taak", "mailBody": ["Beste,", "", "Die taak van u was echt super moeilijk en ik snapte er bijna niks van.", "U had dat ook wel beter kunnen uitleggen want zo kon niemand het maken.", "Ik heb er wel aan gezeten maar het lukte gewoon niet en dat is niet echt mijn fout eigenlijk.", "", "Ik wist ook niet goed wat precies moest dus ja.", "Ik hoop dat u daar rekening mee houd want anders is dat niet eerlijk.", "", "Mvg,", "[naam]"]}, {"type": "mc", "typeLabel": "Meerkeuze", "question": "Welke zin klinkt het beleefdst?", "options": ["Stuur mij dat nu.", "Zou u dat kunnen doorsturen, alstublieft?"], "correctIndex": 1}];
    let currentQuestion = 0;
    let score = 0;

    function renderOptions(options, name) {
      return options.map((opt, index) => (`<label><input type="radio" name="${name}" value="${index}"> ${opt}</label><br>`)).join('');
    }

    function loadQuestion() {
      const q = questions[currentQuestion];
      document.getElementById('qCount').innerText = `Vraag ${currentQuestion + 1} van ${questions.length}`;
      document.getElementById('qType').innerText = q.typeLabel;
      const questionText = document.getElementById('questionText');
      const form = document.getElementById('answerForm');
      form.innerHTML = '';

      if (q.type === 'rewrite') {
        const body = q.mailBody.map((line) => line ? `<p>${line}</p>` : '<br>').join('');
        questionText.innerHTML = `<p>${q.question}</p><div class="mail-example"><h4>Onderwerp: ${q.mailSubject}</h4>${body}</div>`;
      } else {
        questionText.innerText = q.question;
      }

      if (q.type === 'mc') {
        form.innerHTML = renderOptions(q.options, 'answer');
      } else if (q.type === 'open') {
        form.innerHTML = `<input class="text-input" type="text" name="answer" placeholder="Typ je antwoord...">`;
      } else if (q.type === 'drag') {
        const options = ['Kies...', ...q.options];
        form.innerHTML = `<select class="select-input" name="answer">${options.map((opt) => `<option value="${opt}">${opt}</option>`).join('')}</select>`;
      } else if (q.type === 'rewrite') {
        form.innerHTML = '<textarea class="rewrite-input" name="answer" placeholder="Schrijf hier je verbeterde e-mail..."></textarea>';
      }
      document.getElementById('feedback').innerText = '';
      document.getElementById('feedback').className = 'feedback';
      document.getElementById('nextBtn').classList.add('hidden');
    }

    function normalize(value) { return value.trim().toLowerCase(); }

    function checkAnswer() {
      const q = questions[currentQuestion];
      let isCorrect = false;
      if (q.type === 'mc') {
        const selected = document.querySelector('input[name="answer"]:checked');
        if (!selected) return;
        isCorrect = Number(selected.value) === q.correctIndex;
      } else if (q.type === 'open') {
        const input = document.querySelector('input[name="answer"]');
        if (!input || !input.value.trim()) return;
        const normalized = normalize(input.value);
        isCorrect = q.accepted.some((answer) => normalize(answer) === normalized);
      } else if (q.type === 'drag') {
        const selected = document.querySelector('select[name="answer"]');
        if (!selected || selected.value === 'Kies...') return;
        isCorrect = normalize(selected.value) === normalize(q.correctValue);
      } else if (q.type === 'rewrite') {
        const input = document.querySelector('textarea[name="answer"]');
        if (!input || !input.value.trim()) return;
        isCorrect = input.value.trim().length >= 60;
      }

      const feedback = document.getElementById('feedback');
      if (isCorrect) {
        score += 3;
        feedback.innerText = '✅ Juist! +3 XP';
        feedback.classList.add('success');
      } else {
        feedback.innerText = q.type === 'rewrite'
          ? '⚠️ Je tekst is nog te kort. Werk je mail verder uit voor XP.'
          : '❌ Fout. Geen XP.';
        feedback.classList.add('error');
      }
      document.getElementById('nextBtn').classList.remove('hidden');
    }

    function nextQuestion() {
      currentQuestion++;
      if (currentQuestion < questions.length) {
        loadQuestion();
      } else {
        localStorage.setItem('thema7unit2', score);
        if (window.pavoSyncScore) window.pavoSyncScore('thema7unit2', score);
        document.getElementById('quizBox').classList.add('hidden');
        document.getElementById('endScreen').classList.remove('hidden');
        document.getElementById('xpScore').innerText = score;
      }
    }

    window.onload = loadQuestion;
  </script>

  <script src="./unit-navigation.js"></script>
</body>
</html>
