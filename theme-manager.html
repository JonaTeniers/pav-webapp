<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PAV-O Theme Manager PRO</title>

<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">

<style>

:root{
--bg:#f1f5f9;
--panel:#ffffff;
--accent:#0f766e;
--border:#e2e8f0;
--text:#1e293b;
}

body{
margin:0;
font-family:'Nunito',sans-serif;
background:var(--bg);
display:flex;
}

.sidebar{
width:260px;
background:white;
height:100vh;
position:fixed;
padding:20px;
border-right:1px solid var(--border);
}

.sidebar h2{
margin:0;
color:#0b4da2;
}

.sidebar a{
display:block;
margin-top:10px;
padding:10px;
border-radius:8px;
text-decoration:none;
color:var(--text);
font-weight:700;
}

.sidebar a:hover{
background:#e0f2fe;
}

.main{
margin-left:260px;
padding:30px;
display:grid;
grid-template-columns:1fr 1.2fr;
gap:25px;
width:100%;
}

.editor{
background:white;
padding:20px;
border-radius:12px;
overflow:auto;
max-height:90vh;
}

.editor input,
.editor textarea,
.editor select{
width:100%;
padding:8px;
margin-bottom:10px;
border-radius:6px;
border:1px solid var(--border);
}

.editor button{
background:var(--accent);
color:white;
border:none;
padding:8px 14px;
border-radius:6px;
cursor:pointer;
font-weight:700;
margin-bottom:10px;
}

.unit-box{
border:1px solid var(--border);
padding:10px;
border-radius:8px;
margin-bottom:12px;
}

.question-box{
border:1px dashed #cbd5e1;
padding:8px;
margin-top:8px;
border-radius:6px;
}

/* ===== PREVIEW ===== */

.preview{
background:white;
border-radius:12px;
overflow:hidden;
box-shadow:0 6px 18px rgba(0,0,0,0.08);
}

.preview-header{
background:#14b8a6;
color:white;
padding:20px;
text-align:center;
}

.preview-body{
padding:20px;
display:grid;
grid-template-columns:2fr 1fr;
gap:15px;
}

.panel{
background:#ffffff;
border-radius:10px;
padding:15px;
box-shadow:0 4px 12px rgba(0,0,0,0.06);
}

.unit-card{
border:2px solid #bce7e1;
border-radius:10px;
padding:10px;
margin-bottom:8px;
background:#f0fdfa;
}

.mascotte{
width:100%;
border-radius:10px;
}

</style>
</head>

<body>

<nav class="sidebar">
<h2>PAV-O</h2>
<a href="index.html">Leerlingomgeving</a>
</nav>

<div class="main">

<!-- ================= EDITOR ================= -->

<div class="editor">

<h2>Thema</h2>

<input id="title" placeholder="Titel">
<textarea id="desc" placeholder="Beschrijving"></textarea>

<h3>Blokken</h3>

<label><input type="checkbox" id="showFocus" checked> Focus tonen</label>
<label><input type="checkbox" id="showSkills" checked> Wat oefen je</label>
<label><input type="checkbox" id="showLinks"> Links</label>
<label><input type="checkbox" id="showImage"> Afbeelding</label>
<label><input type="checkbox" id="showVideo"> Video</label>
<label><input type="checkbox" id="showExtra"> Extra info</label>

<hr>

<h3>XP</h3>
<input id="themeXP" type="number" placeholder="Thema XP totaal">

<hr>

<h3>Units</h3>

<div id="units"></div>

<button onclick="addUnit()">+ Unit toevoegen</button>

<hr>

<button onclick="saveTheme()">ðŸ’¾ Opslaan</button>

</div>


<!-- ================= PREVIEW ================= -->

<div class="preview">

<div class="preview-header">
<h1 id="pTitle">Thema titel</h1>
<p id="pDesc">Beschrijving</p>
</div>

<div class="preview-body">

<div class="panel">

<h3>Units</h3>
<div id="pUnits"></div>

</div>

<div class="panel">

<h3>Chattie</h3>
<p>Preview</p>

</div>

</div>

</div>

</div>


<script src="./firebase.js"></script>

<script>

let units=[];

/* ================= UNITS ================= */

function addUnit(){

if(units.length>=12){
alert("Max 12 units");
return;
}

const unit={
title:"",
active:true,
xp:0,
questions:[]
};

units.push(unit);
renderUnits();
}

function addQuestion(unitIndex){

if(units[unitIndex].questions.length>=10){
alert("Max 10 vragen");
return;
}

units[unitIndex].questions.push({
type:"open",
question:"",
answers:["","","",""],
correct:"",
xp:10,
image:""
});

renderUnits();
}

/* ================= RENDER ================= */

function renderUnits(){

const container=document.getElementById("units");
const preview=document.getElementById("pUnits");

container.innerHTML="";
preview.innerHTML="";

units.forEach((unit,uIndex)=>{

/* EDITOR */

let html=`
<div class="unit-box">

<h4>Unit ${uIndex+1}</h4>

<input placeholder="Unit titel"
value="${unit.title}"
oninput="units[${uIndex}].title=this.value;updatePreview()">

<select onchange="units[${uIndex}].active=this.value==='true'">
<option value="true">Actief</option>
<option value="false">In ontwikkeling</option>
</select>

<input type="number" placeholder="Unit XP"
value="${unit.xp}"
oninput="units[${uIndex}].xp=parseInt(this.value)||0">

<button onclick="addQuestion(${uIndex})">+ Vraag</button>
`;

unit.questions.forEach((q,qIndex)=>{

html+=`
<div class="question-box">

<strong>Vraag ${qIndex+1}</strong>

<select onchange="units[${uIndex}].questions[${qIndex}].type=this.value">
<option value="open">Open</option>
<option value="ja">Ja/Nee</option>
<option value="meerkeuze">Meerkeuze</option>
<option value="suggestief">Suggestief</option>
<option value="controle">Controle</option>
</select>

<input placeholder="Vraag"
value="${q.question}"
oninput="units[${uIndex}].questions[${qIndex}].question=this.value">

<input placeholder="Antwoord 1"
value="${q.answers[0]}"
oninput="units[${uIndex}].questions[${qIndex}].answers[0]=this.value">

<input placeholder="Antwoord 2"
value="${q.answers[1]}"
oninput="units[${uIndex}].questions[${qIndex}].answers[1]=this.value">

<input placeholder="Antwoord 3"
value="${q.answers[2]}"
oninput="units[${uIndex}].questions[${qIndex}].answers[2]=this.value">

<input placeholder="Antwoord 4"
value="${q.answers[3]}"
oninput="units[${uIndex}].questions[${qIndex}].answers[3]=this.value">

<input placeholder="Juiste antwoord"
value="${q.correct}"
oninput="units[${uIndex}].questions[${qIndex}].correct=this.value">

<input type="number" placeholder="XP"
value="${q.xp}"
oninput="units[${uIndex}].questions[${qIndex}].xp=parseInt(this.value)||0">

<input placeholder="Afbeelding URL"
value="${q.image}"
oninput="units[${uIndex}].questions[${qIndex}].image=this.value">

</div>
`;

});

html+=`</div>`;

container.innerHTML+=html;

/* PREVIEW */

let previewCard="";

if(unit.active){

previewCard=`
<div class="unit-card">
<strong>${unit.title||"Unit"}</strong>
<br><button>Start</button>
</div>
`;

}else{

previewCard=`
<div class="unit-card">
<strong>${unit.title||"Unit"}</strong>
<p>In ontwikkeling</p>
<img src="img/images/pavobouwmascotte.png" class="mascotte">
</div>
`;

}

preview.innerHTML+=previewCard;

});

updatePreview();
}


/* ================= PREVIEW ================= */

function updatePreview(){

document.getElementById("pTitle").innerText=
document.getElementById("title").value || "Thema titel";

document.getElementById("pDesc").innerText=
document.getElementById("desc").value || "Beschrijving";

}


/* ================= SAVE ================= */

async function saveTheme(){

await window.firebaseReady;

await window.db.collection("themes").add({

title:document.getElementById("title").value,
description:document.getElementById("desc").value,
themeXP:parseInt(document.getElementById("themeXP").value)||0,

blocks:{
focus:document.getElementById("showFocus").checked,
skills:document.getElementById("showSkills").checked,
links:document.getElementById("showLinks").checked,
image:document.getElementById("showImage").checked,
video:document.getElementById("showVideo").checked,
extra:document.getElementById("showExtra").checked
},

units:units,
createdAt:firebase.firestore.FieldValue.serverTimestamp()

});

alert("Opgeslagen!");

}


/* ================= INIT ================= */

document.getElementById("title").addEventListener("input",updatePreview);
document.getElementById("desc").addEventListener("input",updatePreview);

</script>

</body>
</html>


